/** 
 * jibo-tools - API for jibo-atom and jibo-cli
 * @version v2.4.5
 * Copyright (c) 2016, Jibo, Inc. All rights reserved.
 * All use of the Jibo SDK is subject to the Jibo SDK End User License Agreement (EULA) 
 * distributed herewith.  If you did not receive a copy of the EULA, you may view a
 * copy at https://developers.jibo.com/license.
 */
!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.app=e()}}(function(){return function e(t,n,o){function i(a,d){if(!n[a]){if(!t[a]){var s="function"==typeof require&&require;if(!d&&s)return s(a,!0);if(l)return l(a,!0);var r=new Error("Cannot find module '"+a+"'");throw r.code="MODULE_NOT_FOUND",r}var u=n[a]={exports:{}};t[a][0].call(u.exports,function(e){var n=t[a][1][e];return i(n?n:e)},u,u.exports,e,t,n,o)}return n[a].exports}for(var l="function"==typeof require&&require,a=0;a<o.length;a++)i(o[a]);return i}({1:[function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(n,"__esModule",{value:!0});var i=e("./settings"),l=o(i);n["default"]={init(e){var t=this;this.mainWindow=e,l["default"].get("isSimulatorDevToolsOpened")&&this.mainWindow.webContents.openDevTools(),this.devToolsWindowDimensionChangesInterval=setInterval(function(){t.mainWindow.webContents.devToolsWebContents},200),this.mainWindow.webContents.on("devtools-opened",function(){if(l["default"].update({isSimulatorDevToolsOpened:!0}),t.mainWindow.webContents.devToolsWebContents){let n=e.webContents.devToolsWebContents.getOwnerBrowserWindow();n.setPosition(l["default"].get("devToolsWindowX"),l["default"].get("devToolsWindowY"))}}),this.mainWindow.webContents.on("devtools-closed",function(){l["default"].update({isSimulatorDevToolsOpened:!1})})},shutdown(){this.devToolsWindowDimensionChangesInterval&&(clearInterval(this.devToolsWindowDimensionChangesInterval),this.devToolsWindowDimensionChangesInterval=null)}}},{"./settings":2}],2:[function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(n,"__esModule",{value:!0});var i=e("path"),l=o(i),a=e("fs"),d=o(a),s=e("lodash"),r=o(s),u=e("app"),c=o(u),f=e("ipc"),g=o(f);let h=l["default"].join(c["default"].getPath("userData"),"simulator-settings.json"),p={contentWidth:1280,contentHeight:720,windowX:50,windowY:50,fullscreen:!1,zoomFactorIndex:4,zoomFactor:1,viewMode:"3d",devToolsWindowX:0,devToolsWindowY:0,devToolsContentWidth:1200,devToolsContentHeight:800,isSimulatorDevToolsOpened:!1,isDevToolsOpened:!1};n["default"]={init(){var t=this;try{this._settings=JSON.parse(d["default"].readFileSync(h,"utf8")),this._settings=r["default"].extend({},p,this._settings)}catch(n){this._settings=p}this.simulatorReady=!1,g["default"].on("get-simulator-settings",function(n){let o=e("./windowing")["default"];n.returnValue=JSON.stringify(t._settings),t.simulatorReady=!0,t.update({zoomFactor:o.getZoom()})})},setWindow(e){this.mainWindow=e},update(e){this._settings=r["default"].extend({},this._settings,e),d["default"].writeFileSync(h,JSON.stringify(this._settings,null,"    "),"utf8"),this.simulatorReady===!0&&this.mainWindow.webContents.send("simulator-settings-changed",JSON.stringify(this._settings))},get(e){return this._settings[e]},all(){return this._settings}}},{"./windowing":3,app:void 0,fs:void 0,ipc:void 0,lodash:void 0,path:void 0}],3:[function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function i(t){let n,o=e("screen");if(!(0>t&&t!==c||t>=r.length)){if(f=t,t===c){n=o.getDisplayMatching(h.getBounds());let i=e("lifesized"),l=i.ppi(n),d=294;g=l/d*n.scaleFactor}else g=r[f];n=o.getDisplayMatching(h.getBounds()),a["default"].update({zoomFactor:g/n.scaleFactor,zoomFactorIndex:f})}}Object.defineProperty(n,"__esModule",{value:!0});var l=e("./settings"),a=o(l),d=e("global-shortcut"),s=o(d);let r=[.5,.67,.75,.9,1,1.1,1.25,1.5,1.75,2,2.5,3,4,5],u=4,c=-2,f=1,g=1,h=null,p={init(){f=a["default"].get("zoomFactorIndex"),g=f===c?1:r[f]},setWindow(e){var t=this;h=e,s["default"].register("CmdOrCtrl+0",function(){p.reset()}),this.dimensionChangeInterval=setInterval(function(){let e=h.getContentSize(),n=t.getScaleFactor();(a["default"].get("windowX")!==h.getBounds().x||a["default"].get("windowY")!==h.getBounds().y||a["default"].get("contentWidth")!==e[0]*n||a["default"].get("contentHeight")!==e[1]*n||a["default"].get("devicePixelRatio")!==n)&&a["default"].update({windowX:h.getBounds().x,windowY:h.getBounds().y,contentWidth:e[0]*n,contentHeight:e[1]*n,devicePixelRatio:n})},200)},shutdown(){this.dimensionChangeInterval&&clearInterval(this.dimensionChangeInterval)},getZoom(){return g},getInitialZoomFactor(){return this.getZoom()},getDisplay(){let t=e("screen");return h?t.getDisplayMatching(h.getBounds()):t.getDisplayMatching({x:a["default"].get("windowX"),y:a["default"].get("windowY"),width:a["default"].get("contentWidth"),height:a["default"].get("contentHeight")})},getScaleFactor(){let e=this.getDisplay();return e.scaleFactor},getMenuItems(){return[{label:"Toggle Full Screen",accelerator:"Ctrl+Command+F",click:function(){h&&(h.setFullScreen(!h.isFullScreen()),a["default"].update({fullscreen:h.isFullScreen()}))}},{label:"Actual Sized (100%)",accelerator:"CmdOrCtrl+0",click:function(){i(u)}},{label:"Zoom In",accelerator:"CmdOrCtrl+=",click:function(){i(f===c?u:f+1)}},{label:"Zoom Out",accelerator:"CmdOrCtrl+-",click:function(){i(f===c?u:f-1)}},{label:"Physical Sized",accelerator:"CmdOrCtrl+4",click:function(){i(c)}},{type:"separator"},{label:"2D View",accelerator:"CmdOrCtrl+2",click:function(){a["default"].update({viewMode:"2d"})}},{label:"3D View",accelerator:"CmdOrCtrl+3",click:function(){a["default"].update({viewMode:"3d"})}},{type:"separator"}]},reset(){i(u,!0)}};n["default"]=p},{"./settings":2,"global-shortcut":void 0,lifesized:void 0,screen:void 0}],4:[function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function i(e){x&&(x!==e&&x.close(),x=null),D["default"].shutdown(),_["default"].shutdown()}function l(){let t=F?C["default"].remote:void 0;F||w["default"].on("registry-init",function(e,n){t=n});let n,o=e("screen");try{n=o.getDisplayMatching({x:y["default"].get("windowX"),y:y["default"].get("windowY"),width:y["default"].get("contentWidth"),height:y["default"].get("contentHeight")})}catch(l){n=o.getDisplayMatching({x:100,y:100,width:1e3,height:1e3})}F&&y["default"].update({viewMode:"2d"});let a={};y["default"].get("fullscreen")?a.fullscreen=!0:(a["use-content-size"]=!0,a.x=y["default"].get("windowX"),a.y=y["default"].get("windowY"),a.width=y["default"].get("contentWidth")/n.scaleFactor,a.height=y["default"].get("contentHeight")/n.scaleFactor),x=new c["default"](a),_["default"].init(x),r["default"].register(M+"J",function(){x&&x.webContents.toggleDevTools()}),D["default"].setWindow(x),y["default"].setWindow(x),w["default"].on("get-registry-host",function(e){e.sender.send("set-registry-host",{registryHost:t,token:C["default"].token})});let d=C["default"].path;process.chdir(p["default"].dirname(d)),x.loadUrl("file://"+p["default"].join((0,S["default"])(__dirname),"index.html")),x.on("closed",function(){i(x)})}var a=e("app"),d=o(a),s=e("global-shortcut"),r=o(s),u=e("browser-window"),c=o(u),f=e("menu"),g=o(f),h=e("path"),p=o(h),m=e("ipc"),w=o(m),v=e("commander"),C=o(v),b=e("./settings"),y=o(b),W=e("./dev-tools"),_=o(W),O=e("./windowing"),D=o(O),T=e("find-root"),S=o(T);d["default"].commandLine.appendSwitch("enable-speech-dispatcher");let x=null;C["default"].option("-p, --path <path>","The path to the skill").option("-r, --remote <address>","Run this as a remote simulation").option("-t, --token <token>","Run this as a remote simulation").option("-f, --frameless","Run with frameless window (no menu bar)").parse(process.argv);let F="undefined"!=typeof C["default"].remote&&C["default"].remote.length>0;w["default"].on("is-remote-mode",function(e){e.returnValue=F.toString()}),C["default"].path||(console.error("You must specify a --path"),process.exit(1));let M="Alt+Command+";"darwin"!=process.platform&&(M="Shift+Control+"),y["default"].init(),w["default"].on("get-skill-path",function(e){e.returnValue=C["default"].path});let k=[{label:"Electron",submenu:[{label:"Quit",accelerator:"CommandOrControl+Q",click:function(){d["default"].quit()}}]},{label:"Edit",submenu:[{label:"Undo",accelerator:"Command+Z",selector:"undo:"},{label:"Redo",accelerator:"Command+Shift+Z",selector:"redo:"},{type:"separator"},{label:"Cut",accelerator:"Command+X",selector:"cut:"},{label:"Copy",accelerator:"Command+C",selector:"copy:"},{label:"Paste",accelerator:"Command+V",selector:"paste:"},{label:"Select All",accelerator:"Command+A",selector:"selectAll:"}]},{label:"View",submenu:[{label:"Reload",accelerator:"CommandOrControl+R",click:function(){x&&x.webContents.send("reload-skill")}},{type:"separator"}].concat(D["default"].getMenuItems()).concat([{label:"Developer",submenu:[{label:"Developer Tools",accelerator:M+"I",click:function(){x&&y["default"].update({isDevToolsOpened:!y["default"].get("isDevToolsOpened")})}}]}])}];d["default"].on("window-all-closed",function(){d["default"].quit()}),d["default"].on("ready",function(){let e=g["default"].buildFromTemplate(k);g["default"].setApplicationMenu(e),l()})},{"./dev-tools":1,"./settings":2,"./windowing":3,app:void 0,"browser-window":void 0,commander:void 0,"find-root":void 0,"global-shortcut":void 0,ipc:void 0,menu:void 0,path:void 0,screen:void 0}]},{},[4])(4)});